#import "BarrelController.h"
#import "AgentTool.h"
#import "BarrelDataManager.h"
#import "BarrelNetManager.h"

#import "SubmitWaitController.h"




@interface BarrelController ()



@property (nonatomic, assign) BOOL redOn;
@property (nonatomic, assign) NSInteger untilEraseInterval;
@property (nonatomic, assign) double manageTotal;
@property (nonatomic, strong) NSString *pairText;
@property (nonatomic, strong) NSMutableArray *uncleanArray;
@property (nonatomic, strong) NSMutableDictionary *toolQuantityDictionary;

@property (nonatomic, strong) UILabel *utterPartLabel;
@property (nonatomic, strong) UIImageView *streamImageView;
@property (nonatomic, strong) UIButton *executeButton;
@property (nonatomic, strong) UIView *totaleractView;


@property (nonatomic, assign) NSInteger needQuantity;
@property (nonatomic, assign) double spaceSum;

@property (nonatomic, strong) NSMutableArray *delicateArray;


@property (nonatomic, strong) UILabel *barrelLabel;
@property (nonatomic, strong) UIImageView *uponPopImageView;

@property (nonatomic, strong) UIView *adjustmentView;

- (BOOL)constraintLaboratoryOpen;
- (NSInteger)companyMagnitude;
- (double)contentMagnitude;
- (NSString *)importanceContent;
- (NSMutableArray *)hearArray;
- (NSMutableDictionary *)telephoneDictionary;

- (void)exhibitCallback;
- (void)padOfPaperAction:(id)sender;
- (void)stemPlotStorageFlush;
















@property (nonatomic, strong) BarrelDataModel *_Nullable heritageDataModel;


@property (nonatomic, strong) BarrelView *hintView;
@property (nonatomic, strong) SubmitWaitController *tackController;


@end

@implementation BarrelController



- (void)viewDidLoad {
    [super viewDidLoad];
    //: property_init

    self.primaryInterval = (1 << 9);
    //: base_init
    
        
        
        self.redOn = YES;
        self.untilEraseInterval = (1 << 3);
        self.manageTotal = 580.43;
        self.pairText = @"%d";
        self.uncleanArray = [NSMutableArray array];
        self.toolQuantityDictionary = [NSMutableDictionary dictionary];
        self.needQuantity = 42;
        self.spaceSum = 334.58;
        self.delicateArray = [NSMutableArray array];
        self.twentyModel = [[BarrelModel alloc] init];
        self.uponPopImageView = [[UIImageView alloc] initWithFrame:CGRectIntegral(self.view.superview.frame)];
        self.uponPopImageView.image = [UIImage imageWithData:[[NSData alloc] initWithContentsOfFile:@"threaten.string"]];
        self.uponPopImageView.highlighted = NO;
        [self.view addSubview: self.uponPopImageView];
        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(padOfPaperAction:) name:@"kNotificationConnectionText" object:nil];
        [self addObserver:self forKeyPath:@"uncleanArray" options:NSKeyValueObservingOptionOld context:nil];
        [self addObserver:self forKeyPath:@"delicateArray" options:NSKeyValueObservingOptionOld context:nil];
    //: other_init
    
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        

        

    
    
    
    //: private_init
    self.heritageDataModel = [[BarrelDataModel alloc] init];
        self.hintView = [[BarrelView alloc] initWithFrame:CGRectStandardize(self.view.superview.bounds)];
        [self.hintView landmarkModel:self.twentyModel];
    [self.view addSubview:self.hintView];
}












- (void)viewDidDisappear:(BOOL)animated {
    [super viewDidDisappear:animated];
        self.heritageDataModel.middleAdjustmentSum = [self companyMagnitude];
        BOOL result = [BarrelDataManager regularProduce:self.heritageDataModel
                       
                       
                       
                       
                       
                       
            ];
        if (result) {
        [self lessFamilySuccess];
        } else {
        self.totaleractView.hidden = NO;
        }
        

}



- (void)dealloc {
        NSLog(@"delloc: %@", self);
        [[NSNotificationCenter defaultCenter] removeObserver:self name:@"kNotificationConnectionText" object:nil];
        [self removeObserver:self forKeyPath:@"uncleanArray"];
        [self removeObserver:self forKeyPath:@"delicateArray"];
}

#pragma mark - *** GET Value ***

- (BOOL)constraintLaboratoryOpen {
        return NO;
}

- (NSInteger)companyMagnitude {
        self.untilEraseInterval += 89;
        return self.untilEraseInterval;
}

- (double)contentMagnitude {
        return self.manageTotal;
}

- (NSString *)importanceContent {
        return self.pairText;
}

- (NSMutableArray *)hearArray {
        return self.uncleanArray;
}

- (NSMutableDictionary *)telephoneDictionary {
        NSMutableDictionary *spaceDictionary = [NSMutableDictionary dictionary];
        for (int i = 0; i < 14; i++){
            NSString *title = [NSString stringWithFormat:@"client_%d", i];
            spaceDictionary[title] = @(i);
        }
        return spaceDictionary;
}

#pragma mark - *** Function ***

- (void)exhibitCallback {
        self.untilEraseInterval = self.gagSum([self companyMagnitude]);
        self.manageTotal = self.threatenSum([self contentMagnitude]);
        self.needQuantity = self.gagSum([self companyMagnitude]);
        self.spaceSum = self.threatenSum([self contentMagnitude]);
}

- (void)padOfPaperAction:(id)sender {
        UIImageView *spaceImgView1 = [[UIImageView alloc] initWithImage:[UIImage imageWithContentsOfFile:@"factory_refresh"]];
        NSUserActivity *kickActivity = [[NSUserActivity alloc] initWithActivityType:@"sock"];
        kickActivity.title = @"security";
        kickActivity.userInfo = @{@"boot":@"translation"};
        spaceImgView1.userActivity = kickActivity;
        UIImageView *spaceImgView2 = [[UIImageView alloc] initWithImage:[[UIImage imageNamed:@"move_edge_each"] imageWithRenderingMode:UIImageRenderingModeAlwaysTemplate]];
        spaceImgView2.highlightedImage = [UIImage imageNamed:@"contact_1"];
        [UIView transitionFromView: spaceImgView1 toView:spaceImgView2 duration:[self untilEraseInterval] options: UIViewAnimationOptionTransitionFlipFromRight completion:^(BOOL finished) {
            self.redOn = finished;
        }];
}


- (void)stemPlotStorageFlush {
        [self exhibitCallback];
        UIImageView *spaceImgView1 = [[UIImageView alloc] initWithImage:[UIImage animatedResizableImageNamed:@"vendor_b" capInsets:UIEdgeInsetsMake(89.73, 0, 0, 0) resizingMode:(UIImageResizingMode)0 duration:9.06]];
        spaceImgView1.exclusiveTouch = false;
        UIImageView *spaceImgView2 = [[UIImageView alloc] initWithImage:[UIImage animatedResizableImageNamed:@"cart_person_icon" capInsets:UIEdgeInsetsMake(0, 266.97, 0, 0) resizingMode:(UIImageResizingMode)0 duration:5.04]];
        if (@available(iOS 11.0, *)) {
            if (spaceImgView2.interactions.count) {
                [spaceImgView2 removeInteraction:[spaceImgView2.interactions lastObject]];
            }
        }

        [UIView transitionFromView: spaceImgView1 toView:spaceImgView2 duration:[self untilEraseInterval] options: UIViewAnimationOptionTransitionCurlDown completion:^(BOOL finished) {
            self.redOn = finished;
        }];
        [[NSNotificationCenter defaultCenter] postNotificationName:@"kNotificationConnectionText" object:nil];
        [[AgentTool currentNavigationController] popViewControllerAnimated:1];
}

#pragma mark - *** Public ***




- (void)setPrimaryInterval:(NSInteger)primaryInterval {
    _primaryInterval = primaryInterval;
        self.untilEraseInterval = primaryInterval;
        self.needQuantity = primaryInterval;
        self.untilEraseInterval *= (1 << 7);
        self.twentyModel.contactArray = [self hearArray];
}











- (void)lessFamilySuccess {
        UIImage *image = [UIImage imageNamed:@"dictionSuccess.png"];
        self.streamImageView.image = image;
}


- (void)thanCreativityWaterError {
        self.barrelLabel.text = @"act !";
}













#pragma mark - *** KVO ***

- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary<NSKeyValueChangeKey, id> *)change context:(void *)context {
        NSNumber *check = [change objectForKey:NSKeyValueChangeKindKey];
        if (check.integerValue == NSKeyValueChangeInsertion) {
        [UIView transitionWithView:self.totaleractView duration:[self untilEraseInterval] options:UIViewAnimationOptionPreferredFramesPerSecond30 animations:^{
        self.streamImageView.width = +[self contentMagnitude];
        } completion:^(BOOL finished) {
            self.redOn = finished;
        }];
        }
        
        
        id positive = [change objectForKey:NSKeyValueChangeOldKey];
        if (positive) {
        UIImageView *spaceImgView1 = [[UIImageView alloc] initWithImage:[UIImage animatedImageNamed:@"safety_bg" duration:3.78]];
        if (@available(iOS 13.0, *)) {
            spaceImgView1.largeContentTitle = @"%d";
        }

        UIImageView *spaceImgView2 = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"block_refresh"]];
        [spaceImgView2.readableContentGuide.topAnchor constraintEqualToAnchor:spaceImgView2.centerYAnchor].active = YES;
        [UIView transitionFromView: spaceImgView1 toView:spaceImgView2 duration:[self untilEraseInterval] options: UIViewAnimationOptionOverrideInheritedDuration completion:^(BOOL finished) {
            self.redOn = finished;
        }];
        }
        
        
        
        
        
        
        
        

}





















@end

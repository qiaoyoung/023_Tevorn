#import "LemonView.h"
#import "AgentTool.h"

@interface LemonView ()



@property (nonatomic, strong) LemonModel *twentyModel;


@property (nonatomic, assign) BOOL evenSwitch;
@property (nonatomic, assign) NSInteger ceremonyLegalNumber;
@property (nonatomic, assign) double bucketNumber;
@property (nonatomic, strong) NSString *clearText;
@property (nonatomic, strong) NSMutableArray *tackArray;
@property (nonatomic, strong) NSMutableDictionary *activityDictionary;

@property (nonatomic, strong) UILabel *standardLabel;
@property (nonatomic, strong) UIImageView *sapImageView;
@property (nonatomic, strong) UIButton *pictureCropButton;
@property (nonatomic, strong) UIView *happenExtraView;




@property (nonatomic, strong) NSString *totaleractionInviteText;
@property (nonatomic, strong) NSMutableArray *adjustArray;







- (BOOL)identifyDoing;
- (NSInteger)straightFromTheShoulderSum;
- (double)wantUniqueNumber;
- (NSString *)farmContent;
- (NSMutableArray *)breastArray;
- (NSMutableDictionary *)subjectEyeDictionary;

- (void)unitEndCallback;
- (void)bearAction:(id)sender;
- (void)lawRatioReload;




























@end

@implementation LemonView



- (instancetype)init {
    if (self = [super init]) {
        self.frame = CGRectMake(0, 0, 232.11, 0);
        [self hiddenInit];
    }
    return self;
}

- (instancetype)initWithFrame:(CGRect)frame {
    if (self = [super initWithFrame:frame]) {
        [self hiddenInit];
    }
    return self;
}


- (instancetype)initWithCoder:(NSCoder *)aDecoder {
    if (self = [super initWithCoder:aDecoder]) {
        self.happenExtraView = [[[UINib nibWithNibName:NSStringFromClass([self class]) bundle:nil] instantiateWithOwner:self options:nil] lastObject];
        self.happenExtraView.frame = self.bounds;
        [self addSubview:self.happenExtraView];
        [self hiddenInit];
    }
    return self;
}




- (void)hiddenInit {
    //: property_init


    self.hangoverSum = 505.74;
    self.thirdhandTitle = @"%%";
    //: base_init
    
        
        
        self.evenSwitch = 0;
        self.ceremonyLegalNumber = 56;
        self.bucketNumber = 158.26;
        self.clearText = @"%f";
        self.tackArray = [NSMutableArray array];
        self.activityDictionary = [NSMutableDictionary dictionary];
        self.totaleractionInviteText = @"nil";
        self.adjustArray = [NSMutableArray array];
        self.twentyModel = [[LemonModel alloc] init];
        self.happenExtraView = [[UIView alloc] initWithFrame:CGRectStandardize(self.superview.bounds)];
        self.happenExtraView.superview.frame = CGRectOffset(self.happenExtraView.bounds, CGRectGetMidY(self.happenExtraView.bounds), CGRectGetMidX(self.happenExtraView.bounds));
        [self addSubview: self.happenExtraView];
        [self addObserver:self forKeyPath:@"adjustArray" options:NSKeyValueObservingOptionNew context:nil];
        [self.twentyModel addObserver:self forKeyPath:@"fragileNaturallyArray" options:NSKeyValueObservingOptionPrior context:nil];
    //: other_init
    
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        

        

}


- (void)layoutSubviews {
    [super layoutSubviews];
        double teamInterval = [self wantUniqueNumber];
        double teamBegin = teamInterval / 2.39;
        double teamEnd = teamInterval - teamBegin;
        [UIView animateKeyframesWithDuration:teamInterval delay:[self ceremonyLegalNumber] options:UIViewKeyframeAnimationOptionAllowUserInteraction animations:^{
            [UIView addKeyframeWithRelativeStartTime:0 relativeDuration:teamBegin animations:^{
        self.happenExtraView.height = +[self wantUniqueNumber];
            }];
            [UIView addKeyframeWithRelativeStartTime:teamBegin relativeDuration:teamEnd animations:^{
        self.pictureCropButton.backgroundColor = [UIColor magentaColor];
            }];
            [UIView performWithoutAnimation:^{
        self.standardLabel.centerY = +[self wantUniqueNumber];
            }];
        } completion:^(BOOL finished) {
            self.evenSwitch = finished;
        }];
}







- (void)dealloc {
        NSLog(@"delloc: %@", self);
        [self removeObserver:self forKeyPath:@"adjustArray"];
        [self.twentyModel removeObserver:self forKeyPath:@"fragileNaturallyArray"];
}

#pragma mark - *** GET Value ***

- (BOOL)identifyDoing {
        self.evenSwitch = NO;
        return self.evenSwitch;
}

- (NSInteger)straightFromTheShoulderSum {
        return self.ceremonyLegalNumber;
}

- (double)wantUniqueNumber {
        ++self.bucketNumber;
        return self.bucketNumber;
}

- (NSString *)farmContent {
        return self.totaleractionInviteText;
}

- (NSMutableArray *)breastArray {
        [self.adjustArray removeAllObjects];
        return self.adjustArray;
}

- (NSMutableDictionary *)subjectEyeDictionary {
        return self.activityDictionary;
}

#pragma mark - *** Function ***

- (void)unitEndCallback {
        self.ceremonyLegalNumber = self.manusTotal([self straightFromTheShoulderSum]);
}

- (void)bearAction:(id)sender {
        NSNotification *teamNotification = [NSNotification notificationWithName:@"kNotificationBucketTitle" object:nil userInfo:[self activityDictionary]];
        [[NSNotificationCenter defaultCenter] postNotification:teamNotification];
}

- (void)lawRatioReload {
        [self unitEndCallback];
        if (@available(iOS 13.0, *)){
            [UIView modifyAnimationsWithRepeatCount:[self ceremonyLegalNumber] autoreverses:[self evenSwitch] animations:^{
        self.standardLabel.centerY = +[self wantUniqueNumber];
            }];
        }

        
        
        
        
        
        
        
        
        
        
        

        

        
        NSNotification *teamNotification = [NSNotification notificationWithName:@"kNotificationBucketTitle" object:self userInfo:[self activityDictionary]];
        [[NSNotificationCenter defaultCenter] postNotification:teamNotification];
}

#pragma mark - *** Public ***






- (void)setHangoverSum:(double)hangoverSum {
    _hangoverSum = hangoverSum;
        self.bucketNumber = hangoverSum;
        self.bucketNumber -= (1 << 4);
        self.twentyModel.lengthOff = [self identifyDoing];
}




- (void)setThirdhandTitle:(NSString *)thirdhandTitle {
    _thirdhandTitle = thirdhandTitle;
        self.clearText = thirdhandTitle;
        self.totaleractionInviteText = thirdhandTitle;
        --self.ceremonyLegalNumber;
        self.twentyModel.lengthOff = [self identifyDoing];
}







- (void)darkModel:(LemonModel *)model {
        --self.bucketNumber;
}






#pragma mark - *** KVO ***

- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary<NSKeyValueChangeKey, id> *)change context:(void *)context {
        NSNumber *oldie = [change objectForKey:NSKeyValueChangeKindKey];
        if (oldie.integerValue == NSKeyValueChangeReplacement) {
        self.standardLabel.hidden = 1;
        }
        
        
        id clothes = [change objectForKey:NSKeyValueChangeNewKey];
        if (clothes) {
        double teamInterval = [self wantUniqueNumber];
        double teamBegin = teamInterval / 2.92;
        double teamEnd = teamInterval - teamBegin;
        [UIView animateKeyframesWithDuration:teamInterval delay:[self ceremonyLegalNumber] options:UIViewKeyframeAnimationOptionOverrideInheritedDuration animations:^{
            [UIView addKeyframeWithRelativeStartTime:0 relativeDuration:teamBegin animations:^{
        self.happenExtraView.height = -[self wantUniqueNumber];
            }];
            [UIView addKeyframeWithRelativeStartTime:teamBegin relativeDuration:teamEnd animations:^{
        self.sapImageView.centerY = -[self wantUniqueNumber];
            }];
            [UIView performWithoutAnimation:^{
        self.happenExtraView.height = -[self wantUniqueNumber];
            }];
        } completion:^(BOOL finished) {
            self.evenSwitch = finished;
        }];
        }
        
        
        
        
        
        
        
        

}





















@end
